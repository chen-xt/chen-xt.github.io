<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="一步一步向前走">
<meta property="og:type" content="website">
<meta property="og:title" content="陈小婷的博客">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="陈小婷的博客">
<meta property="og:description" content="一步一步向前走">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="陈小婷的博客">
<meta name="twitter:description" content="一步一步向前走">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/">





  <title>陈小婷的博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">陈小婷的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">前端开发</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/18/bootstrap-datetimepicker日期插件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chen-xt">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈小婷的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/18/bootstrap-datetimepicker日期插件/" itemprop="url">bootstrap-datetimepicker日期插件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-18T22:44:55+08:00">
                2017-07-18
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bootstrap/" itemprop="url" rel="index">
                    <span itemprop="name">bootstrap</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>&emsp;&emsp;Bootstrap下的datetimepicker插件是一款日期选择器插件，使用起来方便而且界面也是很好看的。</p>
<h2 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h2><h3 id="format"><a href="#format" class="headerlink" title="format"></a>format</h3><p>&emsp;&emsp;时间格式，默认值为<code>mm/dd/yyyy</code>。有几种格式：</p>
<ol>
<li>yyyy-mm-dd</li>
<li>yyyy-mm-dd hh:ii</li>
<li>yyyy-mm-ddThh:ii</li>
<li>yyyy-mm-dd hh:ii:ss</li>
<li>yyyy-mm-ddThh:ii:ssZ<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">format: &apos;yyyy-mm-dd hh:ii&apos; //时间显示到分钟</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="weekStart"><a href="#weekStart" class="headerlink" title="weekStart"></a>weekStart</h3><p>&emsp;&emsp;默认值为0。一周从哪一天开始0（星期日）到6（星期六）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">weekStart:  &apos;1&apos;	//一周从周一开始</span><br></pre></td></tr></table></figure>

<h3 id="startDate"><a href="#startDate" class="headerlink" title="startDate"></a>startDate</h3><p>&emsp;&emsp;开始时间。可以选择的最早日期，这个日期之前的日期都无法被选择。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">startDate: &apos;2017-08-15 14:45&apos; 	//选择的日期最早只能是这个</span><br></pre></td></tr></table></figure>

<h3 id="endDate"><a href="#endDate" class="headerlink" title="endDate"></a>endDate</h3><p>&emsp;&emsp;结束时间。可能选择的最新日期，这个日期以后的日期都无法被选择。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">endDate: &apos;2017-09-08 14:45&apos;	   //选择的日期最新只能是这个</span><br></pre></td></tr></table></figure>

<h3 id="daysOfWeekDisabled"><a href="#daysOfWeekDisabled" class="headerlink" title="daysOfWeekDisabled"></a>daysOfWeekDisabled</h3><p>&emsp;&emsp;禁用星期几。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">daysOfWeekDisabled: &apos;0,6&apos;	//禁用周末，周六、周日的日期无法被选择</span><br></pre></td></tr></table></figure>

<h3 id="autoclose"><a href="#autoclose" class="headerlink" title="autoclose"></a>autoclose</h3><p>&emsp;&emsp;默认值为false，不关闭。当选择好一个日期之后是否立即关闭此日期时间选择器。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">autoclose: &apos;true&apos;	//选好日期后关闭日期时间选择器</span><br></pre></td></tr></table></figure>

<h3 id="startView"><a href="#startView" class="headerlink" title="startView"></a>startView</h3><p>&emsp;&emsp;默认值为2, 首先显示的视图是月份视图。0是小时视图，1是日视图，2是月份视图，3是年视图，4是十年视图。日期时间选择器打开之后首先显示的视图。0小时或小时。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">startView:  &apos;1&apos;    //日视图</span><br></pre></td></tr></table></figure>

<h3 id="minView"><a href="#minView" class="headerlink" title="minView"></a>minView</h3><p>&emsp;&emsp;默认值为0，小时视图。日期时间选择器所能够提供的最精确的时间选择视图。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">minView: &apos;1&apos;   //最精确是到日视图</span><br></pre></td></tr></table></figure>

<h3 id="maxView"><a href="#maxView" class="headerlink" title="maxView"></a>maxView</h3><p>&emsp;&emsp;默认值为4，十年视图。日期时间选择器最高能展示的选择范围视图。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">maxView: &apos;1&apos;   //最高能展示的是日视图</span><br></pre></td></tr></table></figure>

<h3 id="todayBtn"><a href="#todayBtn" class="headerlink" title="todayBtn"></a>todayBtn</h3><p>&emsp;&emsp;默认值为false。如果此值为true 或 “linked”，则在日期时间选择器组件的底部显示一个 <code>Today</code> 按钮用以选择当前日期。如果是true的话，<code>Today</code>按钮仅仅将视图转到当天的日期，如果是<code>linked</code>，当天日期将会被选中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">todayBtn: &apos;true&apos;</span><br></pre></td></tr></table></figure>

<h3 id="keyboardNavigation"><a href="#keyboardNavigation" class="headerlink" title="keyboardNavigation"></a>keyboardNavigation</h3><p>&emsp;&emsp;默认值为true。是否允许通过方向键改变日期。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keyboardNavigation: &apos;false&apos;  //无法通过方向键改变日期</span><br></pre></td></tr></table></figure>

<h3 id="minuteStep"><a href="#minuteStep" class="headerlink" title="minuteStep"></a>minuteStep</h3><p>&emsp;&emsp;默认值为5。小时视图中的可以选择的分钟数间隔为5分钟。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">minuteStep: &apos;10&apos;</span><br></pre></td></tr></table></figure>

<h3 id="showMeridian"><a href="#showMeridian" class="headerlink" title="showMeridian"></a>showMeridian</h3><p>&emsp;&emsp;默认值为false。用于小时视图和日视图，为true视图会显示上下午（AM，PM）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">showMeridian: &apos;true&apos;</span><br></pre></td></tr></table></figure>

<h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><p>&emsp;&emsp;.datetimepicker(options)：初始化日期时间选择器。options的值有以下几个值可以选择。</p>
<h3 id="remove"><a href="#remove" class="headerlink" title="remove"></a>remove</h3><p>&emsp;&emsp;无参数，移除日期时间选择器。同时移除已经绑定的event、内部绑定的对象和HTML元素。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(‘.form_datetime’).datetimepicker(&apos;remove&apos;);  //视图无法显示。时间无法选择</span><br></pre></td></tr></table></figure>

<h3 id="show"><a href="#show" class="headerlink" title="show"></a>show</h3><p>&emsp;&emsp;无参数，显示日期时间选择器。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(‘.form_datetime’).datetimepicker(&apos;show&apos;);  //页面一加载，视图就已经显示</span><br></pre></td></tr></table></figure>


<h3 id="hide"><a href="#hide" class="headerlink" title="hide"></a>hide</h3><p>&emsp;&emsp;无参数，隐藏日期时间选择器。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(‘.form_datetime’).datetimepicker(&apos;hide&apos;);  //页面加载完成时，视图是隐藏的</span><br></pre></td></tr></table></figure>

<h3 id="update"><a href="#update" class="headerlink" title="update"></a>update</h3><p>&emsp;&emsp;无参数，使用当前输入框中的值更新日期时间选择器。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(‘.form_datetime’).datetimepicker(&apos;update&apos;);</span><br></pre></td></tr></table></figure>

<h3 id="setStartDate"><a href="#setStartDate" class="headerlink" title="setStartDate"></a>setStartDate</h3><p>&emsp;&emsp;startDate (String)。给日期时间选择器设置一个新的起始日期。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(&quot;.form_datetime&quot;).datetimepicker(&apos;setStartDate&apos;, &apos;2012-01-01&apos;)</span><br></pre></td></tr></table></figure>

<h3 id="setEndDate"><a href="#setEndDate" class="headerlink" title="setEndDate"></a>setEndDate</h3><p>&emsp;&emsp;endDate (String)。给日期时间选择器设置结束日期。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(&quot;.form_datetime&quot;).datetimepicker(&apos;setEndDate&apos;, &apos;2012-01-01&apos;)</span><br></pre></td></tr></table></figure>

<h3 id="setDaysOfWeekDisabled"><a href="#setDaysOfWeekDisabled" class="headerlink" title="setDaysOfWeekDisabled"></a>setDaysOfWeekDisabled</h3><p>&emsp;&emsp;daysOfWeekDisabled (String|Array)。设置禁用日期，无法被选择的日期。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(&quot;.form_datetime&quot;).datetimepicker(&apos;setDaysOfWeekDisabled&apos;, [0,6]);</span><br></pre></td></tr></table></figure>


<h2 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h2><h3 id="show-1"><a href="#show-1" class="headerlink" title="show"></a>show</h3><p>&emsp;&emsp;当选择器显示时被触发。</p>
<h3 id="hide-1"><a href="#hide-1" class="headerlink" title="hide"></a>hide</h3><p>&emsp;&emsp;当选择器隐藏时被触发。</p>
<h3 id="changeDate"><a href="#changeDate" class="headerlink" title="changeDate"></a>changeDate</h3><p>&emsp;&emsp;当日期被改变时被触发。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(&apos;#date-end&apos;)</span><br><span class="line"> .datetimepicker()</span><br><span class="line">   .on(&apos;changeDate&apos;, function(ev)&#123;</span><br><span class="line">    if (ev.date.valueOf() &lt; date-start-display.valueOf())&#123;</span><br><span class="line">        ....</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="changeYear"><a href="#changeYear" class="headerlink" title="changeYear"></a>changeYear</h3><p>&emsp;&emsp;当十年视图上的年视图被改变时触发。</p>
<h3 id="changeMonth"><a href="#changeMonth" class="headerlink" title="changeMonth"></a>changeMonth</h3><p>&emsp;&emsp;当年视图上的月视图被改变时触发。</p>
<h3 id="outOfRange"><a href="#outOfRange" class="headerlink" title="outOfRange"></a>outOfRange</h3><p>&emsp;&emsp;当用户选择的日期超出<code>startDate</code>或<code>endDate</code>时，或者通过<code>setDate</code> 或<code>setUTCDate</code>方法设置日期超出范围时被触发。</p>
<h2 id="键盘支持"><a href="#键盘支持" class="headerlink" title="键盘支持"></a>键盘支持</h2><h3 id="up-down-left-right方向键"><a href="#up-down-left-right方向键" class="headerlink" title="up/down/left/right方向键"></a>up/down/left/right方向键</h3><p>&emsp;&emsp;<code>left/right</code>向后/向前 一天，<code>up/down</code>向后/向前一周。配合shift键，<code>up/left</code>向后退一个月，<code>down/right</code>向前进一个月。配置ctrl键，<code>up/left</code>向后退一年，<code>down/right</code> 向前进一年。<code>Shift+ctrl</code>和<code>ctrl</code>同等效果，即不能同时改变月和年，只能单独改变年。</p>
<h3 id="escape键"><a href="#escape键" class="headerlink" title="escape键"></a>escape键</h3><p>&emsp;&emsp;可以用来隐藏、重新显示日期时间选择器。</p>
<h3 id="enter键"><a href="#enter键" class="headerlink" title="enter键"></a>enter键</h3><p>&emsp;&emsp;当选择器处于显示状态时，enter键只是将其隐藏。当选择器处于隐藏状态时，enter键发挥通常的功能 - 提交当前表单，或者其他。</p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><ul>
<li><p>绑定输入框，并设置format选项</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;text&quot; value=&quot;2012-05-15 21:05&quot; class=&quot;form_datetime&quot;&gt;</span><br><span class="line"></span><br><span class="line">$(&apos;.form_datetime&apos;).datetimepicker(&#123;</span><br><span class="line">    format: &apos;yyyy-mm-dd hh:ii&apos;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>绑定输入框，并设置format标记</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;text&quot; value=&quot;2012-05-15 21:05&quot; class=&quot;form_datetime&quot; data-date-format=&quot;yyyy-mm-dd hh:ii&quot;&gt;</span><br><span class="line"></span><br><span class="line">$(&apos;.form_datetime&apos;).datetimepicker();</span><br></pre></td></tr></table></figure>
</li>
<li><p>作为组件使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;input-append date&quot; class=&quot;form_datetime&quot; data-date=&quot;12-02-2012&quot; data-date-format=&quot;dd-mm-yyyy&quot;&gt;</span><br><span class="line">    &lt;input size=&quot;16&quot; type=&quot;text&quot; value=&quot;12-02-2012&quot; readonly&gt;</span><br><span class="line">    &lt;span class=&quot;add-on&quot;&gt;&lt;i class=&quot;icon-th&quot;&gt;&lt;/i&gt;&lt;/span&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">$(&apos;.form_datetime&apos;).datetimepicker();</span><br></pre></td></tr></table></figure>
</li>
<li><p>作为内联日期时间选择器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;form_datetime&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">$(&apos;.form_datetime&apos;).datetimepicker();</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="http://www.bootcss.com/p/bootstrap-datetimepicker/index.htm" target="_blank" rel="noopener">参考网址</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/26/基于node-express-multer的文件上传/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chen-xt">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈小婷的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/26/基于node-express-multer的文件上传/" itemprop="url">基于node-express-multer的文件上传</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-26T22:03:07+08:00">
                2017-04-26
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Node-js/" itemprop="url" rel="index">
                    <span itemprop="name">Node.js</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>&emsp;&emsp;<strong>multer</strong>是一个用以处理 <strong>multipart/form-data</strong> 请求的node.js中间件，主要用于上传文件。它基于 busboy 开发以提供最高的性能。本篇文章是基于 multer的1.3.0版本，express的4.13.4版本进行操作的，其中<strong>index.js</strong>是路由文件，用来处理文件上传请求，<strong>form.ejs</strong>是前端页面，用来上传文件。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save multer</span><br></pre></td></tr></table></figure>

<h2 id="修改index-js"><a href="#修改index-js" class="headerlink" title="修改index.js"></a>修改index.js</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var multer  = require(&apos;multer&apos;)</span><br><span class="line">var upload = multer(&#123; dest: &apos;upload/&apos; &#125;);//dest 是上传的文件所在的目录,可以自定义</span><br></pre></td></tr></table></figure>

<h2 id="上传单个文件"><a href="#上传单个文件" class="headerlink" title="上传单个文件"></a>上传单个文件</h2><p>&emsp;&emsp;<strong>.single(fieldname)：</strong>接受一个名称的文件fieldname。单个文件将存储在req.file。</p>
<h3 id="form-ejs"><a href="#form-ejs" class="headerlink" title="form.ejs"></a>form.ejs</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;/upload&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">    &lt;h2&gt;单个文件上传&lt;/h2&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot;  name=&quot;logo&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<h3 id="index-js"><a href="#index-js" class="headerlink" title="index.js"></a>index.js</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">router.post(&apos;/upload&apos;, upload.single(&apos;logo&apos;), function(req, res, next)&#123;</span><br><span class="line">//logo为图片的name属性</span><br><span class="line">      res.redirect(&apos;/form&apos;);</span><br><span class="line">      console.log(req.file.filename); //获取文件的filename值，其他属性类似</span><br><span class="line">      console.log(&apos;单个文件上传&apos;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="上传多个相同name值的文件"><a href="#上传多个相同name值的文件" class="headerlink" title="上传多个相同name值的文件"></a>上传多个相同name值的文件</h2><p>&emsp;&emsp;<strong>.array(fieldname[, maxCount])：</strong>接受一系列的文件，所有的名称fieldname。如果多于maxCount上传文件，可以选择是错误输出。文件数组将存储在 req.files。</p>
<h3 id="form-ejs-1"><a href="#form-ejs-1" class="headerlink" title="form.ejs"></a>form.ejs</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;/upload&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">    &lt;h2&gt;多个文件上传&lt;/h2&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; name=&quot;logo&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; name=&quot;logo&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<h3 id="index-js-1"><a href="#index-js-1" class="headerlink" title="index.js"></a>index.js</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">router.post(&apos;/upload&apos;, upload.array(&apos;logo&apos;, 2), function(req, res, next)&#123;</span><br><span class="line">    res.redirect(&apos;/form&apos;);</span><br><span class="line">    console.log(rreq.files[0].filename); //获取文件的filename值，其他属性类似</span><br><span class="line">    console.log(&apos;多个文件上传&apos;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="上传多个不同name值的文件"><a href="#上传多个不同name值的文件" class="headerlink" title="上传多个不同name值的文件"></a>上传多个不同name值的文件</h2><p>&emsp;&emsp;<strong>.fields(fields)：</strong>接受指定的文件混合fields。具有文件数组的对象将被存储req.files。fields应该是一个数组的对象name和可选的maxCount。</p>
<h3 id="form-ejs-2"><a href="#form-ejs-2" class="headerlink" title="form.ejs"></a>form.ejs</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;/upload&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">    &lt;h2&gt;多个不同name值文件上传&lt;/h2&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; name=&quot;file1&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; name=&quot;file2&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; name=&quot;file3&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; name=&quot;file4&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; name=&quot;file5&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<h3 id="index-js-2"><a href="#index-js-2" class="headerlink" title="index.js"></a>index.js</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">router.post(&apos;/upload&apos;, upload.fields([</span><br><span class="line">    &#123;name: &apos;file1&apos;&#125;,</span><br><span class="line">    &#123;name: &apos;file2&apos;&#125;,</span><br><span class="line">    &#123;name: &apos;file3&apos;&#125;,</span><br><span class="line">    &#123;name: &apos;file4&apos;&#125;,</span><br><span class="line">    &#123;name: &apos;file5&apos;&#125;</span><br><span class="line">]), function(req, res, next)&#123;</span><br><span class="line">     for(var i in req.files)&#123;</span><br><span class="line">        console.log(req.files[i]);//输出每个文件的信息</span><br><span class="line">        var a=req.files[i];</span><br><span class="line">        console.log(a[0].filename);//获取文件的filename值，其他属性类似</span><br><span class="line">    &#125;</span><br><span class="line">    res.redirect(&apos;/form&apos;);</span><br><span class="line">    // console.log(&apos;多个不同name值文件&apos;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;每个文件对象包括以下信息:</p>
<ul>
<li>fieldname: ‘file5’,//在form表单中指定的name属性值</li>
<li>originalname: ‘good5.jpg’,//原始文件名</li>
<li>encoding: ‘7bit’,//文件的编码类型</li>
<li>mimetype: ‘image/jpeg’, //多媒体类型</li>
<li>destination: ‘upload/‘, //文件已被保存到的文件夹(ben)</li>
<li>filename: ‘7df920656f2aea54d6f62f51f58db037’, //保存在本地的文件名(保存后的名称)</li>
<li>path: ‘upload\7df920656f2aea54d6f62f51f58db037’,//文件保存的完整路径</li>
<li>size: 88400 //文件大小，单位b</li>
</ul>
<h2 id="自定义文件名（filename）和文件保存路径"><a href="#自定义文件名（filename）和文件保存路径" class="headerlink" title="自定义文件名（filename）和文件保存路径"></a>自定义文件名（filename）和文件保存路径</h2><p>&emsp;&emsp;multer 提供了 <strong>storage</strong> 这个参数来对资源保存的路径、文件名进行自定义的设置。<br>将<strong>index.js</strong>文件中的<code>var upload = multer({ dest: &#39;upload/&#39; });</code><br>替换成如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var storage = multer.diskStorage(&#123;</span><br><span class="line">  destination: function (req, file, cb) &#123;</span><br><span class="line">    cb(null, &apos;./files&apos;);  //保存的路径，备注：需要自己创建</span><br><span class="line">  &#125;,</span><br><span class="line">  filename: function (req, file, cb) &#123;</span><br><span class="line">    cb(null, file.originalname);//文件名，这里设置成和原始名字一样</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">var upload = multer(&#123; storage: storage &#125;);</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;上述代码的执行结果：所有上传的文件都会保存到files文件夹中，且名字都和原始名字一样。</p>
<h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><p>&emsp;&emsp;multer官方文档：<a href="https://github.com/expressjs/multer" target="_blank" rel="noopener">https://github.com/expressjs/multer</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/04/走进canvas/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chen-xt">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈小婷的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/04/走进canvas/" itemprop="url">走进canvas</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-04T18:36:51+08:00">
                2017-04-04
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/html5/" itemprop="url" rel="index">
                    <span itemprop="name">html5</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="canvas是什么？"><a href="#canvas是什么？" class="headerlink" title="canvas是什么？"></a>canvas是什么？</h2><p>&emsp;&emsp;<code>&lt;canvas&gt;</code>是一个可以使用脚本在其中绘制图形的HTML 元素。什么意思呢？就是canvas元素本身并不绘制图形，它只是相当于一张空画布。如果想在canvas上绘制图形，则必须使用 JavaScript脚本来进行绘制。</p>
<h2 id="canvas的基本用法"><a href="#canvas的基本用法" class="headerlink" title="canvas的基本用法"></a>canvas的基本用法</h2><h3 id="定义-canvas-元素"><a href="#定义-canvas-元素" class="headerlink" title="定义 canvas 元素"></a>定义 canvas 元素</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;canvas id=&quot;canvas&quot; width=&quot;1920&quot; height=&quot;1200&quot;&gt;&lt;/canvas&gt;</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;&emsp;&emsp;<code>&lt;canvas&gt;</code>标签只有两个属性—— <code>width</code>和<code>height</code>，这两个属性都是可选的，当没有设置宽度和高度的时候，canvas会初始化宽度为300像素和高度为150像素。要注意一点，因为<code>&lt;canvas&gt;</code>是<strong>双标签</strong>，所以结束标签<code>&lt;/canvas&gt;</code>一定<strong>不可以省略</strong>。</p>
<h3 id="获取canvas-元素对应的-DOM-对象"><a href="#获取canvas-元素对应的-DOM-对象" class="headerlink" title="获取canvas 元素对应的 DOM 对象"></a>获取canvas 元素对应的 DOM 对象</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//得到DOM对象</span><br><span class="line">var canvas = document.getElementById(&apos;canvas&apos;);</span><br></pre></td></tr></table></figure>

<h3 id="调用-canvas-对象的-getContext-方法"><a href="#调用-canvas-对象的-getContext-方法" class="headerlink" title="调用 canvas 对象的 getContext()方法"></a>调用 canvas 对象的 getContext()方法</h3><p>&emsp;&emsp;&emsp;&emsp;这个方法是用来获得渲染上下文和绘画功能。该方法会返回一个 <code>canvasRenderingContext2D</code>对象，该对象可以绘制图形。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var ctx = canvas.getContext(&apos;2d&apos;);</span><br></pre></td></tr></table></figure>

<h3 id="调用canvas的方法进行绘图"><a href="#调用canvas的方法进行绘图" class="headerlink" title="调用canvas的方法进行绘图"></a>调用canvas的方法进行绘图</h3><p>&emsp;&emsp;&emsp;&emsp;这些后面会提到。</p>
<h2 id="绘制形状"><a href="#绘制形状" class="headerlink" title="绘制形状"></a>绘制形状</h2><h3 id="绘制矩形"><a href="#绘制矩形" class="headerlink" title="绘制矩形"></a>绘制矩形</h3><ul>
<li><strong>rect(x, y, width, height)</strong></li>
</ul>
<p>&emsp;&emsp;&emsp;&emsp;绘制一个左上角坐标为（x,y），宽高为width以及height的矩形。没有填充的话，不会显示。</p>
<ul>
<li><strong>fillRect(x, y, width, height)</strong></li>
</ul>
<p>&emsp;&emsp;&emsp;&emsp;绘制一个左上角坐标为（x,y），宽高为width以及height并填充的矩形，默认填充颜色为黑色。</p>
<ul>
<li><strong>strokeRect(x, y, width, height)</strong></li>
</ul>
<p>&emsp;&emsp;&emsp;&emsp;绘制一个左上角坐标为（x,y），宽高为width以及height的矩形边框，默认边框颜色为黑色。</p>
<ul>
<li><strong>clearRect(x, y, width, height)</strong><br>&emsp;&emsp;清除指定矩形区域，让清除部分完全透明。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//边长为100px的黑色正方形</span><br><span class="line">ctx.fillRect(25,25,100,100); </span><br><span class="line"></span><br><span class="line">//从正方形的中心开始擦除了一个60*60px的正方形</span><br><span class="line">ctx.clearRect(45,45,60,60);</span><br><span class="line"></span><br><span class="line">//在清除区域内生成一个50*50的正方形边框  </span><br><span class="line">ctx.strokeRect(50,50,50,50);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="绘制路径"><a href="#绘制路径" class="headerlink" title="绘制路径"></a>绘制路径</h3><p>&emsp;&emsp;图形的基本元素是路径。一个路径，甚至一个子路径，都是闭合的。以下为常用的几个方法，很多图形其实是通过绘制路径而绘制出来的。</p>
<ul>
<li><strong>beginPath()</strong><br>&emsp;&emsp;新建一条路径，生成之后，图形绘制命令被指向到路径上生成路径。</li>
<li><strong>closePath()</strong><br>&emsp;&emsp;闭合路径之后图形绘制命令又重新指向到上下文中。闭合路径closePath(),不是必需的，比如路径使用填充（filled）时，路径会自动闭合，可以不用closePath()；但是如果使用描边（stroked）则不会闭合路径。</li>
<li><strong>stroke()</strong><br>&emsp;&emsp;通过线条来绘制图形轮廓。</li>
<li><strong>fill()</strong><br>&emsp;&emsp;通过填充路径的内容区域生成实心的图形。</li>
<li><strong>moveTo(x, y)</strong><br>&emsp;&emsp;把 canvas 的当前路径的结束点移动到 x, y 对应的点。通常会使用moveTo()函数设置起点，也可以绘制一些不连续的路径。</li>
</ul>
<h4 id="绘制直线"><a href="#绘制直线" class="headerlink" title="绘制直线"></a>绘制直线</h4><p>&emsp;&emsp;<strong>lineTo(x, y)</strong>：绘制一条从当前位置到指定x以及y位置的直线。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ctx.beginPath();</span><br><span class="line">ctx.moveTo(125,125);</span><br><span class="line">ctx.lineTo(125,45);</span><br><span class="line">ctx.stroke();</span><br></pre></td></tr></table></figure>

<h4 id="绘制三角形"><a href="#绘制三角形" class="headerlink" title="绘制三角形"></a>绘制三角形</h4><p>&emsp;&emsp;绘制三角形其实就是绘制好闭合路径，然后对其进行填充或者描边的效果。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// 填充三角形</span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.moveTo(25,25);</span><br><span class="line">ctx.lineTo(105,25);</span><br><span class="line">ctx.lineTo(25,105);</span><br><span class="line">ctx.fill();</span><br><span class="line"></span><br><span class="line">// 描边三角形</span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.moveTo(125,125);</span><br><span class="line">ctx.lineTo(125,45);</span><br><span class="line">ctx.lineTo(45,125);</span><br><span class="line">ctx.closePath();</span><br><span class="line">ctx.stroke();</span><br></pre></td></tr></table></figure>

<h4 id="绘制圆弧"><a href="#绘制圆弧" class="headerlink" title="绘制圆弧"></a>绘制圆弧</h4><ul>
<li><strong>arc(x, y, radius, startAngle, endAngle, anticlockwise)</strong><br>&emsp;&emsp;画一个以（x,y）为圆心的以radius为半径的圆弧（圆），从startAngle开始到endAngle结束，按照anticlockwise给定的方向（默认为false，顺时针）来生成。</li>
<li><strong>arcTo(x1, y1, x2, y2, radius)</strong><br>&emsp;&emsp;根据给定的控制点和半径画一段圆弧，再以直线连接两个控制点(x1, y1)和(x2, y2)。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var canvas = document.getElementById(&quot;canvas&quot;);</span><br><span class="line">var ctx = canvas.getContext(&quot;2d&quot;);</span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.arc(75, 75, 50, 0, 2 * Math.PI);</span><br><span class="line">ctx.stroke();</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="绘制贝塞尔曲线"><a href="#绘制贝塞尔曲线" class="headerlink" title="绘制贝塞尔曲线"></a>绘制贝塞尔曲线</h4><ul>
<li><strong>quadraticCurveTo(cp1x, cp1y, x, y)</strong><br>&emsp;&emsp;绘制贝塞尔曲线，cp1x,cp1y为控制点，x,y为结束点。</li>
<li><strong>bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y)</strong><br>&emsp;&emsp;绘制二次贝塞尔曲线，cp1x,cp1y为控制点一，cp2x,cp2y为控制点二，x，y为结束点。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">//绘制一个对话气泡</span><br><span class="line">var canvas = document.getElementById(&apos;canvas&apos;);</span><br><span class="line">var ctx = canvas.getContext(&apos;2d&apos;);</span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.moveTo(75,25);</span><br><span class="line">ctx.quadraticCurveTo(25,25,25,62.5);</span><br><span class="line">ctx.quadraticCurveTo(25,100,50,100);</span><br><span class="line">ctx.quadraticCurveTo(50,120,30,125);</span><br><span class="line">ctx.quadraticCurveTo(60,120,65,100);</span><br><span class="line">ctx.quadraticCurveTo(125,100,125,62.5);</span><br><span class="line">ctx.quadraticCurveTo(125,25,75,25);</span><br><span class="line">ctx.stroke();</span><br><span class="line"></span><br><span class="line">//绘制一颗爱心</span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.moveTo(75,40);</span><br><span class="line">ctx.bezierCurveTo(75,37,70,25,50,25);</span><br><span class="line">ctx.bezierCurveTo(20,25,20,62.5,20,62.5);</span><br><span class="line">ctx.bezierCurveTo(20,80,40,102,75,120);</span><br><span class="line">ctx.bezierCurveTo(110,102,130,80,130,62.5);</span><br><span class="line">ctx.bezierCurveTo(130,62.5,130,25,100,25);</span><br><span class="line">ctx.bezierCurveTo(85,25,75,37,75,40);</span><br><span class="line">ctx.fill();</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="添加颜色"><a href="#添加颜色" class="headerlink" title="添加颜色"></a>添加颜色</h2><ul>
<li><strong>fillStyle = color</strong>：设置图形的填充颜色。</li>
<li><strong>strokeStyle = color</strong>：设置图形轮廓的颜色。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ctx.fillStyle = &quot;blue&quot;;</span><br><span class="line">ctx.fillRect(10, 10, 100, 100);</span><br><span class="line">ctx.strokeStyle = &quot;red&quot;;</span><br><span class="line">ctx.strokeRect(10, 10, 100, 100);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="绘制文本"><a href="#绘制文本" class="headerlink" title="绘制文本"></a>绘制文本</h2><ul>
<li><strong>fillText(text, x, y [, maxWidth])</strong><br>&emsp;&emsp;在指定的(x,y)位置填充指定的文本，绘制的最大宽度是可选的。</li>
<li><strong>strokeText(text, x, y [, maxWidth])</strong><br>&emsp;&emsp;在指定的(x,y)位置绘制文本边框，绘制的最大宽度是可选的。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//文字是填充的</span><br><span class="line">ctx.fillText(&quot;Hello world&quot;, 10, 50); </span><br><span class="line">//文字是边框的</span><br><span class="line">ctx.strokeText(&quot;Hello world&quot;, 10, 50);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="使用图片"><a href="#使用图片" class="headerlink" title="使用图片"></a>使用图片</h2><p><strong>drawImage(image, x, y)</strong><br>&emsp;&emsp;其中 image 是 image 或者 canvas 对象，x和y是其在目标canvas里的起始坐标。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var img = new Image();   // 创建一个img元素</span><br><span class="line">img.onload = function()&#123;</span><br><span class="line">// 执行drawImage语句</span><br><span class="line"> ctx.drawImage(img, 0, 0);</span><br><span class="line">&#125;</span><br><span class="line">img.src = &apos;a.png&apos;; // 设置图片源地址</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;若调用 drawImage 方法时，图片还没装载完，那么什么都不会发生。所以应该用load时间来保证不会在加载完毕之前使用这个图片。</p>
<h2 id="状态的保存和恢复"><a href="#状态的保存和恢复" class="headerlink" title="状态的保存和恢复"></a>状态的保存和恢复</h2><p>&emsp;&emsp;<strong>save()</strong>和<strong>restore()</strong>方法是用来保存和恢复 canvas 状态的，都没有参数，这两个是相互匹配出现的。当save()方法被调用后，当前的状态就会被推送到栈中保存；当 restore 方法被调用后，上一个保存的状态就从栈中弹出，所有设定都会恢复。那么<strong>为什么需要保存canvas状态呢</strong>？<br>&emsp;&emsp;当我们对画布进行旋转，缩放，平移等操作的时候，我们只想对特定的元素进行操作，比如图片，一个矩形等，但是当你用canvas的方法来进行这些操作的时候，其实是对整个画布进行了操作，那么之后在画布上的元素都会受到影响，所以在操作之前调用canvas.save()来保存画布当前的状态，当操作之后取出之前保存过的状态，这样就不会对其他的元素进行影响。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ctx.save(); // 保存默认的状态</span><br><span class="line">ctx.fillStyle = &quot;green&quot;;</span><br><span class="line">ctx.fillRect(10, 10, 100, 100);</span><br><span class="line">ctx.restore(); // 还原到上次保存的默认状态</span><br><span class="line">ctx.fillRect(150, 75, 100, 100);</span><br></pre></td></tr></table></figure>

<h2 id="变形"><a href="#变形" class="headerlink" title="变形"></a>变形</h2><h3 id="移动"><a href="#移动" class="headerlink" title="移动"></a>移动</h3><p><strong>translate(x, y)</strong><br>&emsp;&emsp;translate方法接受两个参数。x 是左右偏移量，y 是上下偏移量。对于这个方法，很多人会有个误解，认为translate（x，y）是把点（x，y）作为新的坐标原点。其实并不是这样的。Translate(x,y)表示原来的原点分别在x轴和y轴偏移多远的距离，然后以偏移后的位置作为坐标原点。假如原点落在（1，1），那么translate（10，10）就是在原点（1，1）基础上分别在x轴、y轴移动10，则原点变为（11,11）。</p>
<h3 id="旋转"><a href="#旋转" class="headerlink" title="旋转"></a>旋转</h3><p><strong>rotate(angle)</strong><br>&emsp;&emsp;这个方法只接受一个参数：旋转的角度(angle)，它是顺时针方向的，以弧度为单位的值。要注意的是这里指的是弧度，弧度和度的概念是不一样的，它们之间的关系可以用一个计算公式来表示，<code>弧度＝度 × π/180</code>。</p>
<h3 id="缩放"><a href="#缩放" class="headerlink" title="缩放"></a>缩放</h3><p><strong>scale(x, y)</strong><br>&emsp;&emsp;scale 方法接受两个参数。x,y 分别是横轴和纵轴的缩放因子，它们都必须是正值。值比 1.0 小表示缩小，比 1.0 大则表示放大，值为 1.0 时什么效果都没有。比如设置缩放因子是 0.5，1 个单位就变成对应 0.5 个像素，这样绘制出来的形状就会是原先的一半。</p>
<h2 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h2><p>画一帧动画的步骤：<br>（1）<strong>清空 canvas</strong><br>&emsp;&emsp;除非接下来要画的内容会完全充满 canvas（如背景图），否则需要清空所有，可以用 clearRect()方法来清空。<br>（2）<strong>保存 canvas 状态</strong><br>&emsp;&emsp;如果要改变一些会改变 canvas 状态的设置（样式，变形之类的），又要在每画一帧之时都是原始状态的话，需要先保存一下。<br>（3）<strong>绘制动画图形</strong><br>&emsp;&emsp;这一步才是重绘动画帧。<br>（4）<strong>恢复 canvas 状态</strong><br>&emsp;&emsp;如果已经保存了 canvas 的状态，可以先恢复它，然后重绘下一帧。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">var car = new Image();</span><br><span class="line">function init()&#123;</span><br><span class="line">  car.src = &apos;car.png&apos;;</span><br><span class="line">  window.requestAnimationFrame(draw);</span><br><span class="line">&#125;</span><br><span class="line">function draw()&#123;</span><br><span class="line">      var ctx = document.getElementById(&apos;canvas&apos;).getContext(&apos;2d&apos;);</span><br><span class="line">      ctx.save();</span><br><span class="line">      ctx.clearRect(0, 0, 1920, 1200); </span><br><span class="line">      ctx.scale(0.5, 0.5); </span><br><span class="line">      ctx.rotate(90);</span><br><span class="line">      ctx.drawImage(car, Math.floor(-car.width/2), Math.floor(-car.height/2));</span><br><span class="line">      ctx.restore();</span><br><span class="line">      window.requestAnimationFrame(draw);</span><br><span class="line">  &#125;</span><br><span class="line">$(document).ready(function() &#123;</span><br><span class="line">      init();      </span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;<strong>requestAnimationFrame函数</strong>，传递一个callback参数，在下一个动画帧时，会调用callback。这个函数可以告诉浏览器希望执行一个动画，并在重绘之前，请求浏览器执行一个特定的函数来更新动画。</p>
<h2 id="使用多层画布"><a href="#使用多层画布" class="headerlink" title="使用多层画布"></a>使用多层画布</h2><p>&emsp;&emsp;在画一个复杂的场景时，有些元素不断地改变或者移动，而其它的元素，如背景，永远不变。这个时候可以考虑用多个画布元素去创建不同层次来进行优化，将需要一直变动的元素和不变的元素分开放在不同层次的画布中，便于操作。这里要注意的是canvas<strong>不能嵌套，只能层叠</strong>。<br>&emsp;&emsp;多层的canvas可以通过设置定位来实现每一层都可独立移动而相互之间不影响。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//使用3个canvas</span><br><span class="line">&lt;div id=&quot;container&quot;&gt;</span><br><span class="line">  &lt;canvas id=&quot;canvas1&quot; width=&quot;480&quot; height=&quot;320&quot;&gt;&lt;/canvas&gt;</span><br><span class="line">  &lt;canvas id=&quot;canvas2&quot; width=&quot;480&quot; height=&quot;320&quot;&gt;&lt;/canvas&gt;</span><br><span class="line">  &lt;canvas id=&quot;canvas3&quot; width=&quot;480&quot; height=&quot;320&quot;&gt;&lt;/canvas&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">&lt;style&gt;</span><br><span class="line">  #container &#123;</span><br><span class="line">    width: 480px;</span><br><span class="line">    height: 320px;</span><br><span class="line">    position: relative;</span><br><span class="line">   &#125;</span><br><span class="line">  canvas &#123; position: absolute; &#125;</span><br><span class="line">  #canvas1 &#123; z-index: 3 &#125;</span><br><span class="line">  #canvas2 &#123; z-index: 2 &#125;</span><br><span class="line">  #canvas3 &#123; z-index: 1 &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/04/初识Vue-js/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chen-xt">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈小婷的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/04/初识Vue-js/" itemprop="url">初识Vue.js</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-04T09:55:52+08:00">
                2017-03-04
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue-js/" itemprop="url" rel="index">
                    <span itemprop="name">Vue.js</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Vue-js是什么？"><a href="#Vue-js是什么？" class="headerlink" title="Vue.js是什么？"></a>Vue.js是什么？</h2><p>&emsp;&emsp;<strong>Vue.js</strong>是一套构建用户界面的渐进式框架。<strong>Vue.js</strong>的目标是通过尽可能简单的API实现响应的数据绑定和组合的视图组件。<strong>Vue.js</strong> 的核心是一个允许你采用简洁的模板语法来声明式的将数据渲染进 DOM 的系统。</p>
<h2 id="从“Hello-world-”例子开启Vue之旅"><a href="#从“Hello-world-”例子开启Vue之旅" class="headerlink" title="从“Hello, world!”例子开启Vue之旅"></a>从“Hello, world!”例子开启Vue之旅</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;example&quot;&gt;</span><br><span class="line">	 &#123;&#123; message &#125;&#125; </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=&quot;https://unpkg.com/vue/dist/vue.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">    //通过构造函数 Vue 创建一个 Vue 的根实例</span><br><span class="line">	  var example = new Vue(&#123;</span><br><span class="line">		    el: &apos;#example&apos;,</span><br><span class="line">		    data:&#123;</span><br><span class="line">		        message:&apos;hello world!&apos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Vue常用指令"><a href="#Vue常用指令" class="headerlink" title="Vue常用指令"></a>Vue常用指令</h2><h3 id="v-model"><a href="#v-model" class="headerlink" title="v-model"></a>v-model</h3><p>&emsp;&emsp;在表单控件或者组件上创建双向绑定。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;example&quot;&gt;</span><br><span class="line">	&lt;select v-model=&quot;selected&quot;&gt;</span><br><span class="line">		&lt;option&gt;A&lt;/option&gt;</span><br><span class="line">		&lt;option&gt;B&lt;/option&gt;</span><br><span class="line">		&lt;option&gt;C&lt;/option&gt;</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">	&lt;span&gt;Selected: &#123;&#123; selected &#125;&#125;&lt;/span&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">var example = new Vue(&#123;</span><br><span class="line">	el: &apos;#example&apos;,</span><br><span class="line">	data: &#123;</span><br><span class="line">		selected: &apos;&apos;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="v-if"><a href="#v-if" class="headerlink" title="v-if"></a>v-if</h3><p>&emsp;&emsp;根据其后表达式的<code>bool值</code>进行判断是否渲染该元素。常与<code>v-else-if/v-else</code>一起使用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;example&quot;&gt;</span><br><span class="line">	&lt;h1 v-if=&quot;score === &apos;100&apos;&quot;&gt;优秀&lt;/h1&gt;</span><br><span class="line">	&lt;h1 v-else-if=&quot;score === &apos;100&apos;&quot;&gt;良好&lt;/h1&gt;</span><br><span class="line">	&lt;h1 v-else=&quot;score === &apos;100&apos;&quot;&gt;及格&lt;/h1&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">var example = new Vue(&#123;</span><br><span class="line">    el: &apos;#example&apos;,</span><br><span class="line">    data:&#123;</span><br><span class="line">        score:&apos;100&apos;</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="v-show"><a href="#v-show" class="headerlink" title="v-show"></a>v-show</h3><p>&emsp;&emsp;跟v-if的用法大致一样，不同的是有 <code>v-show</code> 的元素会始终渲染并保持在 DOM 中。<code>v-show</code> 是简单的切换元素的 CSS 属性 display。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;example&quot;&gt;</span><br><span class="line">	&lt;h1 v-show=&quot;ok&quot;&gt;Hello!&lt;/h1&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">var app = new Vue(&#123;</span><br><span class="line">	el: &apos;#example&apos;,</span><br><span class="line">	data: &#123;</span><br><span class="line">		ok: true</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="v-bind"><a href="#v-bind" class="headerlink" title="v-bind"></a>v-bind</h3><p>&emsp;&emsp;用于响应地更新 HTML 特性。可以在其名称后面带一个参数，中间放一个冒号隔开，这个参数通常是HTML元素的特性，如style，class等。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;example&quot; v-bind:style=&quot;styleObject&quot;&gt;</span><br><span class="line">	哈哈哈</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">var example = new Vue(&#123;</span><br><span class="line">	el: &apos;#example&apos;,</span><br><span class="line">	data: &#123;</span><br><span class="line">		styleObject:&#123;</span><br><span class="line">			color: &apos;blue&apos;,</span><br><span class="line">			fontSize: &apos;10px&apos;,</span><br><span class="line">			background: &apos;yellow&apos;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;注意，v-bind可以缩写成<code>：</code> 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 完整语法 --&gt;</span><br><span class="line">&lt;a v-bind:href=&quot;url&quot;&gt;&lt;/a&gt;</span><br><span class="line">&lt;!-- 缩写 --&gt;</span><br><span class="line">&lt;a :href=&quot;url&quot;&gt;&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<h3 id="v-on"><a href="#v-on" class="headerlink" title="v-on"></a>v-on</h3><p>&emsp;&emsp;用于监听指定元素的DOM事件，如点击事件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;example&quot;&gt;</span><br><span class="line">  &lt;button v-on:click=&quot;greet&quot;&gt;greet&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">var example = new Vue(&#123;</span><br><span class="line">	el: &apos;#example&apos;,</span><br><span class="line">	methods:&#123;</span><br><span class="line">		greet: function(event)&#123;</span><br><span class="line">			alert(&apos;hello vue.js!&apos;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;注意，v-on可以缩写成<code>@</code> 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 完整语法 --&gt;</span><br><span class="line">&lt;a v-on:click=&quot;doSomething&quot;&gt;&lt;/a&gt;</span><br><span class="line">&lt;!-- 缩写 --&gt;</span><br><span class="line">&lt;a @click=&quot;doSomething&quot;&gt;&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<h3 id="v-for"><a href="#v-for" class="headerlink" title="v-for"></a>v-for</h3><p>&emsp;&emsp;根据一组数组的选项列表进行渲染。<code>v-for</code> 指令需要以 <code>item in items</code>形式的特殊语法，其中<code>items</code> 是源数据数组，并且 <code>item</code> 是数组元素迭代的别名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul id=&quot;example&quot;&gt;</span><br><span class="line">  	&lt;li v-for=&quot;item in items&quot;&gt;</span><br><span class="line">  		&#123;&#123;item.message&#125;&#125;</span><br><span class="line">  	&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">var example = new Vue(&#123;</span><br><span class="line">	el: &apos;#example&apos;,</span><br><span class="line">	data: &#123;</span><br><span class="line">		items: [</span><br><span class="line">			&#123;</span><br><span class="line">				message: &apos;红楼梦&apos;</span><br><span class="line">			&#125;,</span><br><span class="line">			&#123;</span><br><span class="line">				message: &apos;水浒传&apos;</span><br><span class="line">			&#125;,</span><br><span class="line">			&#123;</span><br><span class="line">				message: &apos;西游记&apos;</span><br><span class="line">			&#125;,</span><br><span class="line">			&#123;</span><br><span class="line">				message: &apos;三国演义&apos;</span><br><span class="line">			&#125;</span><br><span class="line">		]</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;<code>v-for</code> 还支持一个可选的第二个参数为当前项的索引。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;example&quot;&gt;</span><br><span class="line">	&lt;ul&gt;</span><br><span class="line">		&lt;li v-for=&quot;(item, index) in items&quot;&gt;</span><br><span class="line">			&#123;&#123; index &#125;&#125; - &#123;&#123; item.message &#125;&#125;</span><br><span class="line">		&lt;/li&gt;</span><br><span class="line">	&lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">var example = new Vue(&#123;</span><br><span class="line">		el: &apos;#example&apos;,</span><br><span class="line">		data: &#123;</span><br><span class="line">		items: [</span><br><span class="line">			&#123; message: &apos;陈&apos; &#125;,</span><br><span class="line">			&#123; message: &apos;婷&apos; &#125;</span><br><span class="line">		]</span><br><span class="line">	  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h2><p>&emsp;&emsp;模板中的表达式一般只用于简单的操作。如果在模板中放入太多的逻辑会让模板过重且难以维护。这就是为什么 <code>Vue.js</code> 将绑定表达式限制为一个表达式，所以如果需要多于一个表达式的逻辑，应当使用计算属性。</p>
<h3 id="基本例子"><a href="#基本例子" class="headerlink" title="基本例子"></a>基本例子</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;example&quot;&gt;</span><br><span class="line">	&#123;&#123; fullName &#125;&#125;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">var example = new Vue(&#123;</span><br><span class="line">	  el: &apos;#example&apos;,</span><br><span class="line">	  data: &#123;</span><br><span class="line">	    firstName: &apos;Foo&apos;,</span><br><span class="line">	    lastName: &apos;Bar&apos;</span><br><span class="line">	  &#125;,</span><br><span class="line">	computed: &#123;</span><br><span class="line">	    fullName: function () &#123;</span><br><span class="line">	      return this.firstName + &apos; &apos; + this.lastName</span><br><span class="line">	    &#125;</span><br><span class="line">	  &#125;</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="加入setter"><a href="#加入setter" class="headerlink" title="加入setter"></a>加入setter</h3><p>&emsp;&emsp;计算属性默认只有 <code>getter</code> ，可以根据需要提供一个 <code>setter</code>。如下例子，在控制台调用<code>vm.fullName = &#39;John Doe&#39;</code>时，<code>setter</code> 就会被调用。<code>vm.firstName</code>和<code>vm.lastName</code>也会有相应更新。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">var example = new Vue(&#123;</span><br><span class="line">	el: &apos;#example&apos;,</span><br><span class="line">	data: &#123;</span><br><span class="line">		firstName: &apos;陈&apos;,</span><br><span class="line">		lastName: &apos;婷&apos;</span><br><span class="line">	&#125;,</span><br><span class="line">	computed: &#123;</span><br><span class="line">		fullName: &#123;</span><br><span class="line">		// getter</span><br><span class="line">		get: function()&#123;</span><br><span class="line">			return this.firstName + &apos; &apos; + this.lastName</span><br><span class="line">		&#125;,</span><br><span class="line">		// setter</span><br><span class="line">		set: function(newValue)&#123;</span><br><span class="line">			var names = newValue.split(&apos; &apos;)</span><br><span class="line">			this.firstName = names[0]</span><br><span class="line">			this.lastName = names[names.length - 1]</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="计算属性-vs-method"><a href="#计算属性-vs-method" class="headerlink" title="计算属性 vs  method"></a>计算属性 vs  method</h3><p>&emsp;&emsp;<strong>计算属性</strong>与 <strong>method</strong> 的区别在于，计算属性根据它的依赖被缓存，即如果 <code>message</code> 没有被修改，下次 <code>get</code> 不会进行重复计算，而 <code>method</code> 则每次调用都会重新计算。这也意味着如 <code>Date.now()</code> 这样返回的计算属性会永远得不到更新。</p>
<h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><p>&emsp;&emsp;组件可以扩展 HTML 元素，封装可重用的代码。在较高层面上，组件是自定义元素;通过<code>Vue.component()</code>接口将大型应用拆分为各个组件，从而使代码更好具有维护性、复用性以及可读性。</p>
<h3 id="注册"><a href="#注册" class="headerlink" title="注册"></a>注册</h3><p>&emsp;&emsp;要注册一个组件，使用<code>Vue.component(tagName, options)</code>形式。组件在注册之后，便可以在父实例的模块中以自定义元素 <code>&lt;my-component&gt;&lt;/my-component&gt;</code> 的形式使用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;example&quot;&gt;</span><br><span class="line">	&lt;my-component&gt;&lt;/my-component&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">//注册</span><br><span class="line">Vue.component(&apos;my-component&apos;,&#123;</span><br><span class="line">	template: &apos;&lt;div&gt;hello world!&lt;/div&gt;&apos;</span><br><span class="line">&#125;)</span><br><span class="line">//创建根实例</span><br><span class="line">var example = new Vue(&#123;</span><br><span class="line">	el: &apos;#example&apos;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="组件中的data必须是函数"><a href="#组件中的data必须是函数" class="headerlink" title="组件中的data必须是函数"></a>组件中的data必须是函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// Vue 会在控制台发出警告，告诉你在组件中 data 必须是一个函数</span><br><span class="line">Vue.component(&apos;my-component&apos;,&#123;</span><br><span class="line">	template: &apos;&lt;div&gt;&#123;&#123; message &#125;&#125;&lt;/div&gt;&apos;,</span><br><span class="line">	data: &#123;</span><br><span class="line">		message:&apos;hello world!&apos;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line">//data为一个函数，程序正常执行</span><br><span class="line">Vue.component(&apos;my-component&apos;,&#123;</span><br><span class="line">	template: &apos;&lt;div&gt;&#123;&#123; message &#125;&#125;&lt;/div&gt;&apos;,</span><br><span class="line">	data: function()&#123;</span><br><span class="line">		return &#123;</span><br><span class="line">			message: &apos;hello world!&apos;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="Prop"><a href="#Prop" class="headerlink" title="Prop"></a>Prop</h3><h4 id="父组件向子组件传递数据"><a href="#父组件向子组件传递数据" class="headerlink" title="父组件向子组件传递数据"></a>父组件向子组件传递数据</h4><p>&emsp;&emsp;每个组件都是相互隔离的，所以无法在子组件的<code>template</code>中引用父组件的数据。数据只能通过 <code>prop</code>传递。<code>prop</code> 是父组件用来传递数据的一个自定义属性。子组件需要显式地用 <code>props</code>选项声明 <code>“prop”</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;example&quot;&gt;</span><br><span class="line">&lt;!-- 传递props --&gt;</span><br><span class="line">	&lt;child message=&quot;chen-xt&quot;&gt;&lt;/child&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">Vue.component(&apos;child&apos;,&#123;</span><br><span class="line">//声明props</span><br><span class="line">		props: [&apos;message&apos;],</span><br><span class="line">		template: &apos;&lt;div&gt;&#123;&#123; message &#125;&#125;&lt;/div&gt;&apos;</span><br><span class="line">	&#125;)</span><br><span class="line">	var example = new Vue(&#123;</span><br><span class="line">		el: &apos;#example&apos;</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="子组件向父组件传递数据"><a href="#子组件向父组件传递数据" class="headerlink" title="子组件向父组件传递数据"></a>子组件向父组件传递数据</h4><p>&emsp;&emsp;子组件要把数据传递回去可以使用自定义事件。使用 $on(eventName) 监听事件，使用 $emit(eventName) 触发事件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">//子组件通过$emit触发父组件的事件，$emit后面的参数是向父组件传参</span><br><span class="line">&lt;div id=&quot;example&quot;&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123; total &#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;button-counter v-on:increment=&quot;incrementTotal&quot;&gt;&lt;/button-counter&gt;</span><br><span class="line">	&lt;button-counter v-on:increment=&quot;incrementTotal&quot;&gt;&lt;/button-counter&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">Vue.component(&apos;button-counter&apos;,&#123;</span><br><span class="line">		template: &apos;&lt;button v-on:click=&quot;increment&quot;&gt;&#123;&#123; counter &#125;&#125;&lt;/button&gt;&apos;,</span><br><span class="line">		data: function()&#123;</span><br><span class="line">		return&#123;</span><br><span class="line">			counter: 0</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	methods: &#123;</span><br><span class="line">		increment: function()&#123;</span><br><span class="line">			this.counter += 1</span><br><span class="line">			this.$emit(&apos;increment&apos;)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">&#125;)</span><br><span class="line">new Vue(&#123;</span><br><span class="line">	el: &apos;#example&apos;,</span><br><span class="line">	data:&#123;</span><br><span class="line">		total: 0</span><br><span class="line">	&#125;,</span><br><span class="line">	methods:&#123;</span><br><span class="line">		incrementTotal:function()&#123;</span><br><span class="line">			this.total += 1</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="使用Slots分发内容"><a href="#使用Slots分发内容" class="headerlink" title="使用Slots分发内容"></a>使用Slots分发内容</h3><p>&emsp;&emsp;内容分发指的是混合父组件的内容与子组件自己的模板。</p>
<h4 id="单个slot"><a href="#单个slot" class="headerlink" title="单个slot"></a>单个slot</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;h2&gt;我是子组件的标题&lt;/h2&gt;</span><br><span class="line">  &lt;slot&gt;</span><br><span class="line">    只有在没有要分发的内容时才会显示。</span><br><span class="line">  &lt;/slot&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;h1&gt;我是父组件的标题&lt;/h1&gt;</span><br><span class="line">  &lt;my-component&gt;</span><br><span class="line">    &lt;p&gt;这是一些初始内容&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;这是更多的初始内容&lt;/p&gt;</span><br><span class="line">  &lt;/my-component&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 渲染结果：--&gt;</span><br><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;h1&gt;我是父组件的标题&lt;/h1&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;我是子组件的标题&lt;/h2&gt;</span><br><span class="line">    &lt;p&gt;这是一些初始内容&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;这是更多的初始内容&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h4 id="具名slot"><a href="#具名slot" class="headerlink" title="具名slot"></a>具名slot</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;container&quot;&gt;</span><br><span class="line">  &lt;header&gt;</span><br><span class="line">      &lt;slot name=&quot;header&quot;&gt;&lt;/slot&gt;</span><br><span class="line">  &lt;/header&gt;</span><br><span class="line">  &lt;main&gt;</span><br><span class="line">      &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">  &lt;/main&gt;</span><br><span class="line">  &lt;footer&gt;</span><br><span class="line">      &lt;slot name=&quot;footer&quot;&gt;&lt;/slot&gt;</span><br><span class="line">  &lt;/footer&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;app-layout&gt;</span><br><span class="line">    &lt;h1 slot=&quot;header&quot;&gt;这里可能是一个页面标题&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;主要内容的一个段落。&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;另一个主要段落。&lt;/p&gt;</span><br><span class="line">    &lt;p slot=&quot;footer&quot;&gt;这里有一些联系信息&lt;/p&gt;</span><br><span class="line">&lt;/app-layout&gt;</span><br><span class="line">&lt;!-- 渲染结果：--&gt;</span><br><span class="line">&lt;div class=&quot;container&quot;&gt;</span><br><span class="line">  &lt;header&gt;</span><br><span class="line">      &lt;h1&gt;这里可能是一个页面标题&lt;/h1&gt;</span><br><span class="line">  &lt;/header&gt;</span><br><span class="line">  &lt;main&gt;</span><br><span class="line">      &lt;p&gt;主要内容的一个段落。&lt;/p&gt;</span><br><span class="line">      &lt;p&gt;另一个主要段落。&lt;/p&gt;</span><br><span class="line">  &lt;/main&gt;</span><br><span class="line">  &lt;footer&gt;</span><br><span class="line">      &lt;p&gt;这里有一些联系信息&lt;/p&gt;</span><br><span class="line">  &lt;/footer&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h2 id="事件处理器"><a href="#事件处理器" class="headerlink" title="事件处理器"></a>事件处理器</h2><h3 id="简单监听事件"><a href="#简单监听事件" class="headerlink" title="简单监听事件"></a>简单监听事件</h3><p>&emsp;&emsp;用 v-on 指令监听 DOM 事件来触发一些 JavaScript 代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;example&quot;&gt;</span><br><span class="line">	&lt;button v-on:click=&quot;counter += 1&quot;&gt;减少 1&lt;/button&gt;</span><br><span class="line">	&lt;p&gt;这个按钮被点击了 &#123;&#123; counter-10 &#125;&#125; 次。&lt;/p&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">var example = new Vue(&#123;</span><br><span class="line">    el: &apos;#example&apos;,</span><br><span class="line">    data: &#123;</span><br><span class="line">       counter: 10</span><br><span class="line">   &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="方法事件处理器"><a href="#方法事件处理器" class="headerlink" title="方法事件处理器"></a>方法事件处理器</h3><p>&emsp;&emsp;当事件处理的逻辑很复杂的时候，可以将<code>v-on</code> 指令绑定到一个方法上。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;example&quot;&gt;</span><br><span class="line">     &lt;!-- `show` 是在下面定义的方法名 --&gt;</span><br><span class="line">	 &lt;button v-on:click=&quot;show&quot;&gt;show&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"> var example = new Vue(&#123;</span><br><span class="line">	  el: &apos;#example&apos;,</span><br><span class="line">	  data: &#123;</span><br><span class="line">	    name: &apos;chen-xt&apos;,</span><br><span class="line">	    message: &apos; &apos;</span><br><span class="line">	  &#125;,</span><br><span class="line">	  // 在 `methods` 对象中定义方法</span><br><span class="line">	  methods: &#123;</span><br><span class="line">	    show: function (event) &#123;</span><br><span class="line">	      // `this` 在方法里指当前 Vue 实例</span><br><span class="line">	      alert(&apos;Hello &apos; + this.name + &apos;!&apos;)</span><br><span class="line">	      </span><br><span class="line">	    &#125;</span><br><span class="line">	  &#125;</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="内联处理器"><a href="#内联处理器" class="headerlink" title="内联处理器"></a>内联处理器</h3><p>&emsp;&emsp;当事件处理的逻辑很复杂的时候，除了将<code>v-on</code>指令绑定到一个方法上，还可以使用内联 JavaScript 语句。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;example&quot;&gt;</span><br><span class="line">	  &lt;button v-on:click=&quot;show(&apos;hi&apos;)&quot;&gt;Say hi&lt;/button&gt;</span><br><span class="line">	  &lt;button v-on:click=&quot;show(&apos;hello&apos;)&quot;&gt;Say hello&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">var example =new Vue(&#123;</span><br><span class="line">	  el: &apos;#example&apos;,</span><br><span class="line">	  methods: &#123;</span><br><span class="line">	    show: function (message) &#123;</span><br><span class="line">	      alert(message)</span><br><span class="line">	    &#125;</span><br><span class="line">	  &#125;</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;需要在内联语句处理器中访问原生 DOM 事件。可以用特殊变量 <code>$event</code> 把它传入方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;example&quot;&gt;</span><br><span class="line">	 &lt;button v-on:click=&quot;warn(&apos;Form cannot be submitted yet.&apos;, $event)&quot;&gt;</span><br><span class="line">		 Submit</span><br><span class="line">	 &lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">var example =new Vue(&#123;</span><br><span class="line">   el: &apos;#example&apos;,</span><br><span class="line">   methods: &#123;</span><br><span class="line">   warn: function (message, event) &#123;</span><br><span class="line">      // 访问原生事件对象</span><br><span class="line">      if (event) event.preventDefault()</span><br><span class="line">      alert(message)</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="事件修饰符"><a href="#事件修饰符" class="headerlink" title="事件修饰符"></a>事件修饰符</h3><p>&emsp;&emsp;<code>Vue.js</code> 为<code>v-on</code> 提供了事件修饰符来处理 DOM 事件细节，。通过由点(.)表示的指令后缀来调用修饰符。</p>
<ul>
<li>.stop</li>
<li>.prevent</li>
<li>.capture</li>
<li>.self</li>
<li>.once<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 阻止单击事件冒泡 --&gt;</span><br><span class="line">&lt;a v-on:click.stop=&quot;doThis&quot;&gt;&lt;/a&gt;</span><br><span class="line">&lt;!-- 提交事件不再重载页面 --&gt;</span><br><span class="line">&lt;form v-on:submit.prevent=&quot;onSubmit&quot;&gt;&lt;/form&gt;</span><br><span class="line">&lt;!-- 修饰符可以串联  --&gt;</span><br><span class="line">&lt;a v-on:click.stop.prevent=&quot;doThat&quot;&gt;&lt;/a&gt;</span><br><span class="line">&lt;!-- 只有修饰符 --&gt;</span><br><span class="line">&lt;form v-on:submit.prevent&gt;&lt;/form&gt;</span><br><span class="line">&lt;!-- 添加事件侦听器时使用事件捕获模式 --&gt;</span><br><span class="line">&lt;div v-on:click.capture=&quot;doThis&quot;&gt;...&lt;/div&gt;</span><br><span class="line">&lt;!-- 只当事件在该元素本身（而不是子元素）触发时触发回调 --&gt;</span><br><span class="line">&lt;div v-on:click.self=&quot;doThat&quot;&gt;...&lt;/div&gt;</span><br><span class="line">&lt;!-- click 事件至少触发一次 --&gt;</span><br><span class="line">&lt;a v-on:click.once=&quot;doThis&quot;&gt;&lt;/a&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="按键修饰符"><a href="#按键修饰符" class="headerlink" title="按键修饰符"></a>按键修饰符</h3><p>&emsp;&emsp;<code>Vue</code> 允许为<code>v-on</code>在监听键盘事件时添加按键修饰符。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 只有在 keyCode 是 13 时调用 vm.submit() --&gt;</span><br><span class="line">&lt;input v-on:keyup.13=&quot;submit&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;想记住所有的 keyCode 是很有难度的，因此Vue 为最常用的按键提供了别名，如下：</p>
<ul>
<li>.tab</li>
<li>.delete (捕获 “删除” 和 “退格” 键)</li>
<li>.esc</li>
<li>.space</li>
<li>.up</li>
<li>.down</li>
<li>.left</li>
<li>.right</li>
<li>.ctrl</li>
<li>.alt</li>
<li>.shift</li>
<li>.meta<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Alt + C --&gt;</span><br><span class="line">&lt;input @keyup.alt.67=&quot;clear&quot;&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="过渡效果"><a href="#过渡效果" class="headerlink" title="过渡效果"></a>过渡效果</h2><h3 id="过渡的CSS类名"><a href="#过渡的CSS类名" class="headerlink" title="过渡的CSS类名"></a>过渡的CSS类名</h3><ol>
<li><strong>v-enter</strong>: &emsp;定义进入过渡的开始状态。在元素被插入时生效，在下一个帧移除。</li>
<li><strong>v-enter-active</strong>:&emsp; 定义进入过渡的结束状态。在元素被插入时生效，在 <code>transition/animation</code> 完成之后移除。</li>
<li><strong>v-leave</strong>: &emsp;定义离开过渡的开始状态。在离开过渡被触发时生效，在下一个帧移除。</li>
<li><strong>v-leave-active</strong>:&emsp; 定义离开过渡的结束状态。在离开过渡被触发时生效，在 <code>transition/animation</code> 完成之后移除。</li>
</ol>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>&emsp;&emsp;对于这些在 <code>enter/leave</code>过渡中切换的类名，<code>v-</code> 是这些类名的前缀。使用<code>&lt;transition name=&quot;my-transition&quot;&gt;</code>可以重置前缀，比如 <code>v-enter</code> 替换为 <code>my-transition-enter</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">.slide-fade-enter-active &#123;</span><br><span class="line">  transition: all .3s ease;</span><br><span class="line">&#125;</span><br><span class="line">.slide-fade-leave-active &#123;</span><br><span class="line">  transition: all .8s cubic-bezier(1.0, 0.5, 0.8, 1.0);</span><br><span class="line">&#125;</span><br><span class="line">.slide-fade-enter, .slide-fade-leave-active &#123;</span><br><span class="line">  transform: translateX(10px);</span><br><span class="line">  opacity: 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;div id=&quot;example&quot;&gt;</span><br><span class="line">  &lt;button @click=&quot;show = !show&quot;&gt;</span><br><span class="line">      Toggle </span><br><span class="line">  &lt;/button&gt;</span><br><span class="line">  &lt;transition name=&quot;slide-fade&quot;&gt;</span><br><span class="line">      &lt;p v-if=&quot;show&quot;&gt;hello&lt;/p&gt;</span><br><span class="line">  &lt;/transition&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">	var example = new Vue(&#123;</span><br><span class="line">		el: &apos;#example&apos;,</span><br><span class="line">		data: &#123;</span><br><span class="line">		show: true</span><br><span class="line">	   &#125;</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><p>&emsp;&emsp; Vue.js 路由允许我们通过不同的 URL 访问不同的内容。Vue.js 路由需要载入 vue-router 库。<br>&emsp;&emsp; 下面是一个使用 Vue.js + vue-router 实现简单单页应用的例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;app&quot;&gt;</span><br><span class="line">  &lt;h1&gt;Hello 路由!&lt;/h1&gt;</span><br><span class="line">  &lt;p&gt;</span><br><span class="line">	    &lt;!-- 使用 router-link 组件来导航. --&gt;</span><br><span class="line">	    &lt;!-- 通过传入 `to` 属性指定链接. --&gt;</span><br><span class="line">	    &lt;!-- &lt;router-link&gt; 默认会被渲染成一个 `&lt;a&gt;` 标签 --&gt;</span><br><span class="line">	    &lt;router-link to=&quot;/foo&quot;&gt;Go to Foo&lt;/router-link&gt;</span><br><span class="line">	    &lt;router-link to=&quot;/bar&quot;&gt;Go to Bar&lt;/router-link&gt;</span><br><span class="line">  &lt;/p&gt;</span><br><span class="line">  &lt;!-- 路由出口：路由匹配到的组件将渲染在这里 --&gt;</span><br><span class="line">  &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">//  定义（路由）组件。</span><br><span class="line">const Foo = &#123; template: &apos;&lt;div&gt;foo&lt;/div&gt;&apos; &#125;</span><br><span class="line">const Bar = &#123; template: &apos;&lt;div&gt;bar&lt;/div&gt;&apos; &#125;</span><br><span class="line"> </span><br><span class="line">// 定义路由：每个路由应该映射一个组件。</span><br><span class="line">const routes = [</span><br><span class="line">    &#123; path: &apos;/foo&apos;, component: Foo &#125;,</span><br><span class="line">    &#123; path: &apos;/bar&apos;, component: Bar &#125;</span><br><span class="line">]</span><br><span class="line"> </span><br><span class="line">//创建 router 实例，然后传 `routes` 配置</span><br><span class="line">const router = new VueRouter(&#123;</span><br><span class="line">   routes // （缩写）相当于 routes: routes</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line">// 创建和挂载根实例：要通过 router 配置参数注入路由，从而让整个应用都有路由功能</span><br><span class="line">const app = new Vue(&#123;</span><br><span class="line">     router</span><br><span class="line">&#125;).$mount(&apos;#app&apos;)</span><br></pre></td></tr></table></figure>

<h2 id="响应式原理"><a href="#响应式原理" class="headerlink" title="响应式原理"></a>响应式原理</h2><h3 id="如何追踪变化"><a href="#如何追踪变化" class="headerlink" title="如何追踪变化"></a>如何追踪变化</h3><p>&emsp;&emsp;把一个普通 Javascript 对象传给 Vue 实例的 <code>data</code> 选项，Vue 将遍历此对象所有的属性，并使用 <code>Object.defineProperty</code>把这些属性全部转为 <code>getter/setter</code>。</p>
<h3 id="变化检测问题"><a href="#变化检测问题" class="headerlink" title="变化检测问题"></a>变化检测问题</h3><p>&emsp;&emsp; Vue 不能检测到对象属性的添加或删除。由于 Vue 会在初始化实例时对属性执行 <code>getter/setter</code> 转化过程，所以属性必须在 data 对象上存在才能让 Vue 转换它，这样才能让它是响应的。所以可以使用 <code>Vue.set(object, key, value)</code> 方法将响应属性添加到嵌套的对象上。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var vm = new Vue(&#123;</span><br><span class="line">  data:&#123;</span><br><span class="line">  a:1</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">// vm.a 是响应的</span><br><span class="line">vm.b = 2</span><br><span class="line">// vm.b 是非响应的</span><br></pre></td></tr></table></figure>

<h3 id="声明响应式属性"><a href="#声明响应式属性" class="headerlink" title="声明响应式属性"></a>声明响应式属性</h3><p>&emsp;&emsp; 由于 Vue 不允许动态添加根级响应式属性，所以你必须在初始化实例前声明根级响应式属性，即使是一个空值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var vm = new Vue(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    // 声明 message 为一个空值字符串</span><br><span class="line">    message: &apos;&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  template: &apos;&lt;div&gt;&#123;&#123; message &#125;&#125;&lt;/div&gt;&apos;</span><br><span class="line">&#125;)</span><br><span class="line">// 之后设置 message </span><br><span class="line">vm.message = &apos;Hello!&apos;</span><br></pre></td></tr></table></figure>

<h3 id="异步更新队列"><a href="#异步更新队列" class="headerlink" title="异步更新队列"></a>异步更新队列</h3><p>&emsp;&emsp;Vue.js 默认异步执行DOM更新 。每当观察到数据变化时，Vue 就开始一个队列，将同一事件循环内所有的数据变化缓存起来。如果一个 <code>watcher</code> 被多次触发，只会推入一次到队列中。等到下一次事件循环，Vue 将清空队列，只进行必要的 DOM 更新。<br>&emsp;&emsp;注意，当设置 <code>vm.someData = &#39;new value&#39;</code> 时，该组件不会立即重新渲染。为了在数据变化之后等待 Vue 完成更新 DOM，可以在数据变化之后立即使用 <code>Vue.nextTick(callback)</code> 。这样回调函数在 DOM 更新完成后就会调用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;example&quot;&gt;&#123;&#123;message&#125;&#125;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">var vm = new Vue(&#123;</span><br><span class="line">  el: &apos;#example&apos;,</span><br><span class="line">  data: &#123;</span><br><span class="line">    message: &apos;123&apos;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">vm.message = &apos;new message&apos; // 更改数据</span><br><span class="line">vm.$el.textContent === &apos;new message&apos; // false</span><br><span class="line">Vue.nextTick(function () &#123;</span><br><span class="line">  vm.$el.textContent === &apos;new message&apos; // true</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="http://cn.vuejs.org/v2/guide/" target="_blank" rel="noopener">Vue.js官方教程</a></li>
<li><a href="http://cn.vuejs.org/v2/api/" target="_blank" rel="noopener">Vue.js API</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/18/Mongoose的基本使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chen-xt">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈小婷的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/18/Mongoose的基本使用/" itemprop="url">Mongoose的基本使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-12-18T13:10:21+08:00">
                2016-12-18
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Node-js/" itemprop="url" rel="index">
                    <span itemprop="name">Node.js</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>&emsp;&emsp;<strong>MongoDB</strong> 是一个对象数据库，它没有表、行等概念，也没有固定的模式和结构，所有的数据以文档的形式存储。在MongoDB中，多个文档(Document)可以组成集合(Collection)，多个集合又可以组成数据库。<br>&emsp;&emsp;<strong>Mongoose</strong>是MongoDB的一个对象模型工具,也是针对MongoDB操作的一个对象模型库，封装了MongoDB对文档的的一些增删改查等常用方法，让NodeJS操作Mongodb数据库变得更加灵活简单。</p>
<h2 id="安装及引用"><a href="#安装及引用" class="headerlink" title="安装及引用"></a>安装及引用</h2><h3 id="安装mongoose"><a href="#安装mongoose" class="headerlink" title="安装mongoose"></a>安装mongoose</h3><p><code>npm install mongoose</code></p>
<h3 id="引用mongoose"><a href="#引用mongoose" class="headerlink" title="引用mongoose"></a>引用mongoose</h3><p><code>var mongoose = require(&quot;mongoose&quot;);</code></p>
<h3 id="使用”mongoose”连接数据库"><a href="#使用”mongoose”连接数据库" class="headerlink" title="使用”mongoose”连接数据库"></a>使用”mongoose”连接数据库</h3><p><code>var db = mongoose.connect(&quot;mongodb://user:pass@localhost:port/database&quot;);</code></p>
<h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><h3 id="Schema"><a href="#Schema" class="headerlink" title="Schema"></a>Schema</h3><p>&emsp;&emsp;一种以文件形式存储的数据库模型骨架，不具备对数据库的操作能力，仅仅只是数据库模型在程序片段中的一种表现，可以说是数据属性模型，又或者是“集合”的模型骨架。<br>&emsp;&emsp;基本属性类型有：字符串、日期型、数值型、布尔型、null、数组、内嵌文档等。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var mongoose = require(&quot;mongoose&quot;);</span><br><span class="line">var TestSchema = new mongoose.Schema(&#123;</span><br><span class="line">    name : &#123; type:String &#125;, //属性name,类型为String</span><br><span class="line">    age  : &#123; type:Number, default:0 &#125;,      //属性age,类型为Number,默认为0</span><br><span class="line">    time : &#123; type:Date, default:Date.now &#125;,</span><br><span class="line">    email: &#123; type:String,default:&apos;&apos;&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h3><p>&emsp;&emsp;由Schema构造生成的模型，除了Schema定义的数据库骨架以外，还具有数据库操作的行为。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//通过Schema来创建Model</span><br><span class="line">var db = mongoose.connect(&quot;mongodb://127.0.0.1:27017/test&quot;);</span><br><span class="line">var TestModel = db.model(&quot;test1&quot;, TestSchema);   // 创建Model</span><br><span class="line">//test1为数据库中的集合名称，添加数据时如果test1已经存在，则会保存到其目录下，如果未存在，则会创建test1集合，然后再保存数据。</span><br></pre></td></tr></table></figure>

<h3 id="Entity"><a href="#Entity" class="headerlink" title="Entity"></a>Entity</h3><p>&emsp;&emsp;由Model创建的实体，使用save方法保存数据，Model和Entity都有能影响数据库的操作，但Model比Entity更具操作性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//使用Model创建Entity</span><br><span class="line">var TestEntity = new TestModel(&#123;</span><br><span class="line">       name : &quot;Lenka&quot;,</span><br><span class="line">       age  : 36,</span><br><span class="line">       email: &quot;lenka@qq.com&quot;</span><br><span class="line">&#125;);</span><br><span class="line">console.log(TestEntity.name);   // Lenka</span><br><span class="line">console.log(TestEntity.age);  // 36</span><br></pre></td></tr></table></figure>

<h2 id="保存数据"><a href="#保存数据" class="headerlink" title="保存数据"></a>保存数据</h2><h3 id="Model保存"><a href="#Model保存" class="headerlink" title="Model保存"></a>Model保存</h3><p>&emsp;&emsp;Model.create(文档数据, callback));</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Model.create(&#123; name:&quot;model_create&quot;, age:26&#125;, function(error,doc)&#123;</span><br><span class="line">    if(error) &#123;</span><br><span class="line">        console.log(error);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        console.log(doc);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Entity保存"><a href="#Entity保存" class="headerlink" title="Entity保存"></a>Entity保存</h3><p>&emsp;&emsp;Entity.save(文档数据, callback));</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var Entity = new Model(&#123;name:&quot;entity_save&quot;,age: 27&#125;);</span><br><span class="line">Entity.save(function(error,doc) &#123;</span><br><span class="line">    if(error) &#123;</span><br><span class="line">        console.log(error);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        console.log(doc);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;<strong>注意：</strong> model调用的是create方法，entity调用的是save方法。</p>
<h2 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a>更新数据</h2><p>&emsp;&emsp;根据条件更新相关数据。<br>&emsp;&emsp;&emsp;&emsp;obj.update(查询条件,更新对象,callback);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var conditions = &#123;name : &apos;test_update&apos;&#125;; </span><br><span class="line">var update = &#123;$set : &#123; age : 16 &#125;&#125;;</span><br><span class="line">TestModel.update(conditions, update, function(error)&#123;</span><br><span class="line">    if(error) &#123;</span><br><span class="line">        console.log(error);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        console.log(&apos;Update success!&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h2><p>&emsp;&emsp;根据条件删除相关数据。<br>&emsp;&emsp;&emsp;&emsp;obj.remove(查询条件,callback);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var conditions = &#123; name: &apos;tom&apos; &#125;; </span><br><span class="line">TestModel.remove(conditions, function(error)&#123;</span><br><span class="line">    if(error) &#123;</span><br><span class="line">        console.log(error);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        console.log(&apos;Delete success!&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="查询数据"><a href="#查询数据" class="headerlink" title="查询数据"></a>查询数据</h2><h3 id="简单查询"><a href="#简单查询" class="headerlink" title="简单查询"></a>简单查询</h3><h4 id="find查询"><a href="#find查询" class="headerlink" title="find查询"></a>find查询</h4><p>&emsp;&emsp;返回符合条件一个、多个或者空数组文档结果。<br>&emsp;&emsp;&emsp;&emsp;obj.find(查询条件,callback);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Model.find(&#123;&#125;,function(error,docs)&#123;</span><br><span class="line">    console.log(docs);//没有向find传递参数，默认的是显示所有文档</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">Model.find(&#123; &quot;age&quot;: 28 &#125;, function (error, docs) &#123;</span><br><span class="line">  if(error)&#123;</span><br><span class="line">     console.log(&quot;error :&quot; + error);</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">     console.log(docs); //显示 age为28的所有文档</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="find过滤查询"><a href="#find过滤查询" class="headerlink" title="find过滤查询"></a>find过滤查询</h4><p>&emsp;&emsp;可以过滤返回结果所显示的属性个数。<br>&emsp;&emsp;&emsp;&emsp;find(Conditions,field,callback); 其中field省略或为Null，则返回所有属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//返回只包含一个键值name、age的所有记录</span><br><span class="line">Model.find(&#123;&#125;,&#123;name:1, age:1, _id:0&#125;，function(err,docs)&#123;</span><br><span class="line">    console.log(docs);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;把要显示的数据设置为大于0 的数即可，通常设置为1；_id是默认返回，不显示则设置为0.但是，对于非 _id的属性不显示的话不可以设置为0，否则会抛异常或查询无果。</p>
<h4 id="findOne查询"><a href="#findOne查询" class="headerlink" title="findOne查询"></a>findOne查询</h4><p>&emsp;&emsp;只返回第一个符合条件的文档数据。<br>&emsp;&emsp;&emsp;&emsp;findOne(Conditions,callback);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 查询符合age等于27的第一条数据</span><br><span class="line">TestModel.findOne(&#123; age: 27&#125;, function (err, doc)&#123;</span><br><span class="line">       console.log(doc);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="findById查询"><a href="#findById查询" class="headerlink" title="findById查询"></a>findById查询</h4><p>&emsp;&emsp;只接收文档的_id作为参数，返回单个文档。<br>&emsp;&emsp;&emsp;&emsp;findById(_id, callback);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TestModel.findById(&apos;obj._id&apos;, function (err, doc)&#123;</span><br><span class="line">    console.log(doc);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="高级查询"><a href="#高级查询" class="headerlink" title="高级查询"></a>高级查询</h3><h4 id="gt-gt-、-lt-lt-、-lte-lt-、-gte-gt-操作符"><a href="#gt-gt-、-lt-lt-、-lte-lt-、-gte-gt-操作符" class="headerlink" title="$gt(&gt;)、$lt(&lt;)、$lte(&lt;=)、$gte(&gt;=)操作符"></a>$gt(&gt;)、$lt(&lt;)、$lte(&lt;=)、$gte(&gt;=)操作符</h4><p>&emsp;&emsp;针对Number类型的查询具有超强的排除性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//查询所有age大于18的数据</span><br><span class="line">Model.find(&#123;&quot;age&quot;:&#123;&quot;$gt&quot;:18&#125;&#125;,function(error,docs)&#123;</span><br><span class="line">    console.log(docs);</span><br><span class="line">&#125;);</span><br><span class="line">//查询所有age小于60的数据</span><br><span class="line">Model.find(&#123;&quot;age&quot;:&#123;&quot;$lt&quot;:60&#125;&#125;,function(error,docs)&#123;</span><br><span class="line">     console.log(docs);</span><br><span class="line">&#125;);</span><br><span class="line">//查询所有age大于等于18小于60的数据</span><br><span class="line">Model.find(&#123;&quot;age&quot;:&#123;&quot;$gte&quot;:18,&quot;$lt&quot;:60&#125;&#125;,function(error,docs)&#123;</span><br><span class="line">    console.log(docs);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h4 id="ne-操作符"><a href="#ne-操作符" class="headerlink" title="$ne(!=)操作符"></a>$ne(!=)操作符</h4><p>&emsp;&emsp;相当于不等于、不包含，查询时可根据单个或多个属性进行结果排除。$ne可以匹配单个值，也可以匹配不同类型的值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//查询age不等于24的所有数据</span><br><span class="line">Model.find(&#123; age:&#123; $ne:24&#125;&#125;,function(error,docs)&#123;</span><br><span class="line">    console.log(docs);</span><br><span class="line">&#125;);</span><br><span class="line">//查询name不等于tom、age&gt;=18的所有数据</span><br><span class="line">Model.find(&#123;name:&#123;$ne:&quot;tom&quot;&#125;,age:&#123;$gte:18&#125;&#125;,function(error,docs)&#123;</span><br><span class="line">    console.log(docs);</span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure>

<h4 id="in操作符"><a href="#in操作符" class="headerlink" title="$in操作符"></a>$in操作符</h4><p>&emsp;&emsp;查找包含于指定字段条件的数据。和$ne操作符用法相同，但意义相反。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//查询age等于20的所有数据</span><br><span class="line">Model.find(&#123; age:&#123; $in: 20&#125;&#125;,function(error,docs)&#123;</span><br><span class="line">    console.log(docs);</span><br><span class="line">&#125;);</span><br><span class="line">//查询age为20和30的所有数据</span><br><span class="line">Model.find(&#123; age:&#123;$in:[20,30]&#125;&#125;,function(error,docs)&#123;</span><br><span class="line">    console.log(docs);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="or操作符"><a href="#or操作符" class="headerlink" title="$or操作符"></a>$or操作符</h4><p>&emsp;&emsp;可查询多个条件，只要满足其中一个就可返回结果值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//查询name为yaya或age为28的全部文档</span><br><span class="line">Model.find(&#123;&quot;$or&quot;:[&#123;&quot;name&quot;:&quot;yaya&quot;&#125;,&#123;&quot;age&quot;:28&#125;]&#125;,function(error,docs)&#123;</span><br><span class="line">    console.log(docs);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="exists操作符"><a href="#exists操作符" class="headerlink" title="$exists操作符"></a>$exists操作符</h4><p>&emsp;&emsp;主要用于判断某些属性是否存在。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//查询所有存在name属性的文档</span><br><span class="line">Model.find(&#123;name: &#123;$exists: true&#125;&#125;,function(error,docs)&#123;</span><br><span class="line">    console.log(docs);</span><br><span class="line">&#125;);</span><br><span class="line">//查询所有不存在telephone属性的文档</span><br><span class="line">Model.find(&#123;telephone: &#123;$exists: false&#125;&#125;,function(error,docs)&#123;</span><br><span class="line">  console.log(docs);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="游标"><a href="#游标" class="headerlink" title="游标"></a>游标</h2><p>&emsp;&emsp;对数据库返回的find执行结果进行控制，可以限制结果的数量，略过部分结果，根据任意键按任意顺序的组合对结果进行各种排序，或者是执行其他一些强的操作。主要包括限制返回结果的数量(limit函数)、忽略一点数量的结果(skip函数)以及排序(sort函数)。</p>
<h3 id="limit函数"><a href="#limit函数" class="headerlink" title="limit函数"></a>limit函数</h3><p>&emsp;&emsp;限制返回结果的数量（limit函数指定的是上限而非下限）。<br>&emsp;&emsp;&emsp;&emsp;find(Conditions,fields,options,callback);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//以age为条件、过滤属性为null的所有文档，限制文档数量为20</span><br><span class="line">Model.find(&#123;age:27&#125;,null,&#123;limit:20&#125;,function(err,docs)&#123;</span><br><span class="line">    console.log(docs);</span><br><span class="line">&#125;);</span><br><span class="line">//如果匹配的结果不到20个，则返回匹配数量的结果。</span><br></pre></td></tr></table></figure>

<h3 id="skip函数"><a href="#skip函数" class="headerlink" title="skip函数"></a>skip函数</h3><p>&emsp;&emsp;略过指定数量的匹配结果，返回余下的查询结果。<br>&emsp;&emsp;&emsp;&emsp;find(Conditions,fields,options,callback);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//跳过前4条查询结果，只返回剩下的查询结果</span><br><span class="line">Model.find(&#123;&#125;,null,&#123;skip:4&#125;,function(err,docs)&#123;</span><br><span class="line">    console.log(docs);</span><br><span class="line">&#125;);</span><br><span class="line">//如果查询结果数量中少于4个的话，则不会返回任何结果。</span><br></pre></td></tr></table></figure>

<h3 id="sort函数"><a href="#sort函数" class="headerlink" title="sort函数"></a>sort函数</h3><p>&emsp;&emsp;对返回结果进行有效排序。该函数的参数是一个或多个键/值对，键代表要排序的键名，值代表排序的方向，1是升序，-1是降序。<br>&emsp;&emsp;&emsp;&emsp;find(Conditions,fields,options,callback);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//查询所有数据，并按照age降序顺序返回数据docs</span><br><span class="line">Model.find(&#123;&#125;,null,&#123;sort:&#123;age:-1&#125;&#125;,function(err,docs)&#123;</span><br><span class="line">        console.log(docs);</span><br><span class="line"> &#125;);</span><br><span class="line">//查询所有文档(只显示属性name和age)且按照age升序展示结果</span><br><span class="line">TestModel.find(&#123;&#125;,</span><br><span class="line">               &#123;name: 1, age: 1, _id: 0 &#125;,</span><br><span class="line">               &#123;sort:&#123;age: 1 &#125;&#125;,</span><br><span class="line">               function(err,docs)&#123;</span><br><span class="line">                     console.log(docs);</span><br><span class="line">                &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="属性方法"><a href="#属性方法" class="headerlink" title="属性方法"></a>属性方法</h2><p>&emsp;&emsp;每一个文档都有一个主键“_id”，这个键在文档所属的集合中是唯一的。这个主键名称是固定的，默认是ObjectId类型，该类型的值由系统自己生成。<br>&emsp;&emsp;ObjectId是一个12字节的 BSON 类型字符串。按照字节顺序，依次代表：4字节：UNIX时间戳；3字节：表示运行MongoDB的机器；2字节：表示生成此_id的进程；3字节：由一个随机数开始的计数器生成的值</p>
<h3 id="为Schema添加属性值"><a href="#为Schema添加属性值" class="headerlink" title="为Schema添加属性值"></a>为Schema添加属性值</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var mongoose = require(&apos;mongoose&apos;);</span><br><span class="line">var TempSchema = new mongoose.Schema;</span><br><span class="line">TempSchema.add(&#123;</span><br><span class="line">     name: &apos;String&apos;, </span><br><span class="line">     email: &apos;String&apos;, </span><br><span class="line">     age: &apos;Number&apos; </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Schema实例方法"><a href="#Schema实例方法" class="headerlink" title="Schema实例方法"></a>Schema实例方法</h3><p>&emsp;&emsp;为后面的Model和Entity提供公共的方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var mongoose = require(&apos;mongoose&apos;);</span><br><span class="line">var saySchema = new mongoose.Schema(&#123;name : String&#125;);</span><br><span class="line">saySchema.method(&apos;say&apos;, function () &#123;</span><br><span class="line">     console.log(&apos;hello&apos;);</span><br><span class="line">&#125;)</span><br><span class="line">var say = mongoose.model(&apos;say&apos;, saySchema);</span><br><span class="line">var h = new say();</span><br><span class="line">h.say();  //hello</span><br></pre></td></tr></table></figure>

<h3 id="Schema静态方法"><a href="#Schema静态方法" class="headerlink" title="Schema静态方法"></a>Schema静态方法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var mongoose = require(&quot;mongoose&quot;);</span><br><span class="line">var db = mongoose.connect(&quot;mongodb://127.0.0.1:27017/test&quot;);</span><br><span class="line">var TestSchema = new mongoose.Schema(&#123;</span><br><span class="line">    name : &#123; type:String &#125;,</span><br><span class="line">    age  : &#123; type:Number, default:0 &#125;,</span><br><span class="line">    email: &#123; type:String, default:&quot;&quot; &#125;,</span><br><span class="line">    time : &#123; type:Date, default:Date.now &#125;</span><br><span class="line">&#125;);</span><br><span class="line">TestSchema.static(&apos;findByName&apos;, function (name, callback) &#123;</span><br><span class="line">    return this.find(&#123; name: name &#125;, callback);</span><br><span class="line">&#125;);</span><br><span class="line">var TestModel = db.model(&quot;test1&quot;, TestSchema );</span><br><span class="line">//查询所有名字叫tom的文档结果集</span><br><span class="line">TestModel.findByName(&apos;tom&apos;, function (err, docs) &#123;</span><br><span class="line">    console.log(docs);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Schema追加方法"><a href="#Schema追加方法" class="headerlink" title="Schema追加方法"></a>Schema追加方法</h3><p>&emsp;&emsp;有时因为场景的需要，需要为Schema模型追加方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//为Schema模型追加speak方法</span><br><span class="line">var mongoose = require(&quot;mongoose&quot;);</span><br><span class="line">var db = mongoose.connect(&quot;mongodb://127.0.0.1:27017/test&quot;);</span><br><span class="line">var TestSchema = new mongoose.Schema(&#123;</span><br><span class="line">    name : &#123; type:String &#125;,</span><br><span class="line">    age  : &#123; type:Number, default:0 &#125;,</span><br><span class="line">    email: &#123; type:String, default:&quot;&quot; &#125;,</span><br><span class="line">    time : &#123; type:Date, default:Date.now &#125;</span><br><span class="line">&#125;);</span><br><span class="line">TestSchema.methods.speak = function()&#123;</span><br><span class="line">    console.log(&apos;我的名字叫&apos;+this.name);</span><br><span class="line">&#125;</span><br><span class="line">var TestModel = db.model(&apos;test1&apos;,TestSchema);</span><br><span class="line">var TestEntity = new TestModel(&#123;name:&apos;Lenka&apos;&#125;); </span><br><span class="line">TestEntity.speak();   //我的名字叫Lenka</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">chen-xt</p>
              <p class="site-description motion-element" itemprop="description">一步一步向前走</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">33</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">31</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">chen-xt</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
